<!DOCTYPE html><html class="mozilla"><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
    






<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<title>[NANOWAR-15] Nanowar - session-scope serialization fails if app-scope container is not serializable</title>
<script type="text/javascript"><!--
/* Script removed by snapshot save */
--></script>













































    




<link rel="shortcut icon" href="index_files/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="https://jira.codehaus.org/osd.jsp" title="[NANOWAR-15] Nanowar - session-scope serialization fails if app-scope container is not serializable - jira.codehaus.org">

    


<!--[if IE]><![endif]-->
<script type="text/javascript"><!--
/* Script removed by snapshot save */
--></script>
<link type="text/css" rel="stylesheet" href="index_files/batch.css" media="all">
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-huda6k-1988229788/6162/7/7/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-huda6k-1988229788/6162/7/7/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="index_files/batch-1.css" media="all">
<script type="text/javascript" src="index_files/batch.js"></script><style type="text/css"></style>
<!--[if lte IE 8]>
<script type="text/javascript" src="/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-huda6k-1988229788/6162/7/7/_/download/superbatch/js/batch.js?conditionalComment=lte+IE+8" ></script>
<![endif]-->
<script type="text/javascript" src="index_files/batch-1.js"></script>
<script type="text/javascript" src="index_files/jira.webresources_calendar-en.js"></script>
<script type="text/javascript" src="index_files/com.atlassian.administraticksearch-webresources.js"></script>

<script type="text/javascript" src="index_files/shortcuts.js"></script>


    
    
    
    <meta name="decorator" content="atl.general">
    <meta id="isNavigator" name="isNavigator" content="true">
    <meta name="ajs-user.search.mode" content="basic">
    <meta name="ajs-issue-search-help-title" content="Searching for Issues">
    <meta name="ajs-issue-search-help-url" content="https://docs.atlassian.com/jira/docs-061/Searching+for+Issues">
    <meta name="ajs-advanced-search-help-title" content="Performing Advanced Searches">
    <meta name="ajs-advanced-search-help-url" content="https://docs.atlassian.com/jira/docs-061/Advanced+Searching">
    
</head>
<body data-aui-version="5.1.8" id="jira" class="aui-layout aui-theme-default ka ajax-issue-search-and-view page-type-navigator navigator-issue-only" data-version="6.1.6">
<div id="page">
    <header id="header" style="display:none" role="banner">
        



    
        
            
        
    







        




        





<fieldset class="parameters hidden dont-default-focus">
    <input title="tzdetect.pref.tzid" value="America/Chicago" type="hidden">
    <input title="tzdetect.pref.tzname" value="(GMT-06:00) Chicago" type="hidden">
    <input title="tzdetect.pref.tzoffset" value="(GMT-06:00)" type="hidden">
    <input title="tzdetect.pref.tzdst" value="true" type="hidden">
    <input title="tzdetect.pref.nothanks" value="" type="hidden">
</fieldset>
<nav data-aui-responsive="true" class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class="aui-dropdown2-trigger app-switcher-trigger" aria-owns="app-switcher" aria-haspopup="true" tabindex="0"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default"><div class="aui-dropdown2-section"><ul class="nav-links"><li class="nav-link nav-link-local"><a href="https://jira.codehaus.org/" class="aui-dropdown2-radio interactive checked" title="https://jira.codehaus.org/"><span class="nav-link-label">jira.codehaus.org</span></a></li><li class="nav-link"><a href="http://jira.sonarsource.com/" class="aui-dropdown2-radio interactive" title="http://jira.sonarsource.com/"><span class="nav-link-label">SonarSource</span></a></li><li class="nav-link"><a href="http://docs.codehaus.org/" class="aui-dropdown2-radio interactive" title="http://docs.codehaus.org/"><span class="nav-link-label">Codehaus</span></a></li><li class="nav-link"><a href="http://xircles.codehaus.org/" class="aui-dropdown2-radio interactive" title="http://xircles.codehaus.org"><span class="nav-link-label">Xircles</span></a></li></ul></div></div><script><!--
/* Script removed by snapshot save */
--></script></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://jira.codehaus.org/secure/MyJiraHome.jspa"><img data-aui-responsive-header-index="0" src="urn:download-error:http://www.codehaus.org/codehaus-small.gif" alt="jira.codehaus.org"></a></h1><ul style="width: auto;" class="aui-nav">




<li><a class="aui-nav-link aui-dropdown2-ajax jira-ajax-menu aui-dropdown2-trigger " href="https://jira.codehaus.org/secure/Dashboard.jspa" id="home_link" accesskey="d" title="View and manage your dashboards" aria-haspopup="true" aria-owns="home_link-content">Dashboards</a><div id="home_link-content" class="aui-dropdown2 aui-style-default" data-aui-dropdown2-ajax-key="home_link"></div></li><li><a class="aui-nav-link aui-dropdown2-ajax jira-ajax-menu aui-dropdown2-trigger " href="index.htmlWAR" id="browse_link" accesskey="p" title="View recent projects and browse a list of projects" aria-haspopup="true" aria-owns="browse_link-content">Projects</a><div id="browse_link-content" class="aui-dropdown2 aui-style-default" data-aui-dropdown2-ajax-key="browse_link"></div></li><li><a class="aui-nav-link aui-dropdown2-ajax jira-ajax-menu aui-dropdown2-trigger " href="https://jira.codehaus.org/secure/IssueNavigator.jspa" id="find_link" accesskey="i" title="Search for issues and view recent issues" aria-haspopup="true" aria-owns="find_link-content">Issues</a><div id="find_link-content" class="aui-dropdown2 aui-style-default" data-aui-dropdown2-ajax-key="find_link"></div></li>
<li style="display: none;"><a id="aui-responsive-header-dropdown-trigger-0" class="aui-dropdown2-trigger" aria-owns="aui-responsive-header-dropdown-content-0" aria-haspopup="true" href="#">More<span class="icon aui-icon-dropdown"></span></a><div id="aui-responsive-header-dropdown-content-0" class="aui-dropdown2 aui-style-default"><div class="aui-dropdown2-section"><ul id="aui-responsive-header-dropdown-list-0"></ul></div></div></li></ul></div><div class="aui-header-secondary"><ul class="aui-nav"><li>
    <form action="https://jira.codehaus.org/secure/QuickSearch.jspa" method="post" id="quicksearch" class="aui-quicksearch dont-default-focus ajs-dirty-warning-exempt">
        <input id="quickSearchInput" class="search" title="Quick Search ( Type '/' )" placeholder="Quick Search" name="searchString" accesskey="q" type="text">
        <input class="hidden" value="Search" type="submit">
    </form>
</li>



    <li id="system-help-menu">
        <a class="aui-nav-link aui-dropdown2-trigger" aria-haspopup="true" aria-owns="system-help-menu-content" href="https://docs.atlassian.com/jira/docs-061/JIRA+Documentation" target="_blank" title="Help"><span class="aui-icon aui-icon-small aui-iconfont-help">Help</span></a>
        <div id="system-help-menu-content" class="aui-dropdown2 aui-style-default">
                            <div class="aui-dropdown2-section">
                                                                <ul id="jira-help" class="aui-list-truncate">
                                                            <li>
                                    <a id="view_help" class="interactive" title="Goto the online documentation for JIRA" href="https://docs.atlassian.com/jira/docs-061/JIRA+Documentation" target="_blank">Online Help</a>
                                </li>
                                                            <li>
                                    <a id="keyshortscuthelp" class="interactive" title="Get more information about JIRA's Keyboard Shortcuts ( Type '?' )" href="https://jira.codehaus.org/secure/ViewKeyboardShortcuts%21default.jspa" target="_blank">Keyboard Shortcuts</a>
                                </li>
                                                            <li>
                                    <a id="view_about" class="interactive" title="Get more information about JIRA" href="https://jira.codehaus.org/secure/AboutPage.jspa">About JIRA</a>
                                </li>
                                                            <li>
                                    <a id="view_credits" class="interactive" title="See who did what" href="https://jira.codehaus.org/secure/JiraCreditsPage%21default.jspa" target="_blank">JIRA Credits</a>
                                </li>
                                                            <li>
                                    <a id="whats-new-menu-link" class="interactive" href="https://docs.atlassian.com/jira/docs-061/whatsnew/iframe">What?s New</a>
                                </li>
                                                    </ul>
                                    </div>
                    </div>
    </li>









<li id="user-options">
            <a class="aui-nav-link login-link" href="https://jira.codehaus.org/login.jsp?os_destination=%2Fbrowse%2FNANOWAR-15">Log In</a>
                <div id="user-options-content" class="aui-dropdown2 aui-style-default">
                            <div class="aui-dropdown2-section">
                                                        </div>
                    </div>
    </li>
</ul></div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    </header>
    


<div id="announcement-banner" class="alertHeader">
    <div style="position: absolute; right: 20em; top: -2em">
  <a href="https://xircles.codehaus.org/signup">Signup</a>
</div>
</div>


    <section id="content" role="main">
        
    

    <div class="issue-container ">
                                    <div id="issue-content" class="issue-edit-form">
                    <header id="stalker" class="issue-header js-stalker">
                        <div class="issue-header-content"><header class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-image"><span id="11001" class="aui-avatar aui-avatar-large aui-avatar-project jira-system-avatar"><span class="aui-avatar-inner"><img id="project-avatar" alt="NanoContainer NanoWar" src="index_files/projectavatar.png"></span></span></div><!-- .aui-page-header-image --><div class="aui-page-header-main"><ol class="aui-nav aui-nav-breadcrumbs"><li><a id="project-name-val" href="index.htmlWAR">NanoContainer NanoWar</a></li><li><a class="issue-link" data-issue-key="NANOWAR-15" href="#" id="key-val" rel="22074">NANOWAR-15</a></li></ol><h1 id="summary-val">Nanowar - session-scope serialization fails if app-scope container is not serializable</h1></div><!-- .aui-page-header-main --><div class="aui-page-header-actions"><div id="issue-header-pager"></div></div><!-- .aui-page-header-actions --></div><!-- .aui-page-header-inner --></header><!-- .aui-page-header --><div class="command-bar"><div class="ops-cont"><div class="ops-menus aui-toolbar"><div class="toolbar-split toolbar-split-left"><ul id="opsbar-ops-login-lnk_container" class="toolbar-group pluggable-ops"><li class="toolbar-item"><a id="ops-login-lnk" style="display:none" title="Log In" class="toolbar-trigger" href="https://jira.codehaus.org/login.jsp?os_destination=%2Fbrowse%2FNANOWAR-15"><span class="trigger-label">Log In</span></a></li></ul><ul id="opsbar-opsbar-operations" class="toolbar-group pluggable-ops"></ul><ul id="opsbar-opsbar-transitions" class="toolbar-group pluggable-ops"></ul><ul id="opsbar-opsbar-admin" class="toolbar-group pluggable-ops"></ul></div><div class="toolbar-split toolbar-split-right"><ul id="opsbar-jira.issue.tools" style="display:none" class="toolbar-group pluggable-ops"><li class="toolbar-item toolbar-dropdown"><div><a href="#" id="viewissue-export" title="Export this issue in another format" data-hide-on-scroll=".split-view .issue-container" data-contain-to-window="true" class="toolbar-trigger  js-default-dropdown"><span class="icon icon-export viewissue-export"></span> <span class="dropdown-text">Export</span><span class="icon drop-menu"></span></a><div class="aui-list hidden"><ul class="aui-list-section aui-first aui-last"><li class="aui-list-item"><a href="https://jira.codehaus.org/si/jira.issueviews:issue-xml/NANOWAR-15/NANOWAR-15.xml" class="aui-list-item-link" id="jira.issueviews:issue-xml"><span class="trigger-label">XML</span></a></li><li class="aui-list-item"><a href="https://jira.codehaus.org/si/jira.issueviews:issue-word/NANOWAR-15/NANOWAR-15.doc" class="aui-list-item-link" id="jira.issueviews:issue-word"><span class="trigger-label">Word</span></a></li><li class="aui-list-item"><a href="https://jira.codehaus.org/si/jira.issueviews:issue-html/NANOWAR-15/NANOWAR-15.html" class="aui-list-item-link" id="jira.issueviews:issue-html"><span class="trigger-label">Printable</span></a></li></ul></div></div></li></ul></div></div></div></div></div>
                    </header>
                    <div class="issue-body-content">
                        <div class="aui-group issue-body"><div class="aui-item issue-main-column"><div id="details-module" class="module toggle-wrap"><div id="details-module_heading" class="mod-header"><ul class="ops"></ul><h2 class="toggle-title">Details</h2></div><div class="mod-content">




<ul id="issuedetails" class="property-list two-cols">
    <li class="item">
        <div class="wrap">
            <strong class="name">Type:</strong>
            <span id="type-val" class="value">
                                <img alt="Bug" src="index_files/bug.png" title="Bug - A problem which impairs or prevents the functions of the product." height="16" width="16"> Bug
            </span>
        </div>
    </li>
    <li class="item item-right">
        <div class="wrap">
            <strong class="name">Status:</strong>
            <span id="status-val" class="value">
                                

<img src="index_files/open.png" alt="Open" title="Open - The issue is open and ready for the assignee to start work on it." height="16" width="16"> Open
            </span>
                    </div>
    </li>
            <li class="item">
            <div class="wrap">
                <strong class="name">Priority:</strong>
                <span id="priority-val" class="value">
                                        <img alt="Major" src="index_files/major.png" title="Major - Major loss of function." height="16" width="16"> Major
                </span>
            </div>
        </li>
                                <li class="item item-right">
            <div class="wrap">
                <strong class="name">Resolution:</strong>
                <span id="resolution-val" class="value unresolved">
                                    Unresolved
                                </span>
            </div>
        </li>
                <li class="item">
            <div class="wrap">
                <strong class="name">Affects Version/s:</strong>
                <span id="versions-val" class="value">
                                            None
                                    </span>
            </div>
        </li>
                <li class="item item-right">
            <div class="wrap">
                <strong class="name">Fix Version/s:</strong>
                <span id="fixfor-val" class="value">
                                            <span style="height: auto;" class="shorten" id="fixVersions-field">
                                                            <a href="index.htmlWAR/fixforversion/12014" title="1.1 ">1.1</a>                                                    </span>
                                    </span>
            </div>
        </li>
                <li class="item">
            <div class="wrap">
                <strong class="name">Component/s:</strong>
                <span id="components-val" class="value">
                                            <span style="height: auto;" class="shorten" id="components-field">
                                                            <a href="index.htmlWAR/component/11625" title="core ">core</a>                                                    </span>
                                    </span>
            </div>
        </li>
                    <li class="item full-width">
            <div class="wrap" id="wrap-labels">
                <strong class="name">Labels:</strong>
                    <div class="labels-wrap value">
            <span class="labels" id="labels-22074-value">None</span>
                </div>
            </div>
        </li>
        </ul>

<div id="customfieldmodule">
    <div class="aui-tabs horizontal-tabs" id="customfield-tabs">
                    <div id="customfield-panel-1" class="tabs-pane active-pane">
                        <ul class="property-list">
                                                <li id="rowForcustomfield_10210" class="item">
                        <div class="wrap">
                            <strong title="Number of attachments " class="name">Number of attachments :</strong>
                            <div id="customfield_10210-val" class="value type-attachments" data-fieldtype="attachments" data-fieldtypecompletekey="com.atlassian.jira.toolkit:attachments">
                                    2

                            </div>
                        </div>
                    </li>
                                        </ul>
        </div>
        </div></div>
</div></div><div id="descriptionmodule" class="module toggle-wrap"><div id="descriptionmodule_heading" class="mod-header"><ul class="ops"></ul><h2 class="toggle-title">Description</h2></div><div class="mod-content"><div id="description-val" class="field-ignore-highlight">
    <div class="user-content-block">
                    <p>If the app-scope container is not serializable, then when the session-scope container is serialized by the app server (for fail-over, etc) - it attempts to serialize its parent (the app-scope container), but fails with a NotSerializableException.</p>

<p>Here is a patch which fixes the problem by putting a wrapper around the app-scope container. The wrapper looks up the app-scope container in the servlet context each time it is needed. Because the only state in the wrapper is the app-scope container key, it can be successfully serialized.</p>

<p>SessionSerializationIntegrationTestCase has a test to demonstrate the current problem and another test to demonstrate the fix.</p>
            </div>
</div>
</div></div><div id="attachmentmodule" class="module toggle-wrap"><div id="attachmentmodule_heading" class="mod-header"><ul class="ops"><li class="drop"><div class="aui-dd-parent"><a href="#" class="icon drop-menu js-default-dropdown" title="Options"><span>Options</span></a><div class="aui-dropdown-content aui-list"><ul id="attachment-sorting-options" class="aui-list-section aui-first"><li class="aui-list-item"><a id="attachment-sort-key-name" href="index.htmlWAR-15?attachmentSortBy=fileName#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="viewissue.subtasks.tab.show.all.name"><span>Sort By Name</span></a></li><li class="aui-list-item"><a id="attachment-sort-key-date" href="index.htmlWAR-15?attachmentSortBy=dateTime#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Sort By Date"><span>Sort By Date</span></a></li></ul><ul id="attachment-sorting-order-options" class="aui-list-section"><li class="aui-list-item"><a id="attachment-sort-direction-asc" href="index.htmlWAR-15?attachmentOrder=asc#attachmentmodule" class="aui-list-checked aui-checked aui-list-item-link" title="Ascending"><span>Ascending</span></a></li><li class="aui-list-item"><a id="attachment-sort-direction-desc" href="index.htmlWAR-15?attachmentOrder=desc#attachmentmodule" class="aui-list-checked aui-list-item-link" title="Descending"><span>Descending</span></a></li></ul><ul id="attachment-manage-options" class="aui-list-section aui-last"><li class="aui-list-item"><a id="aszip" href="attachmentzip/22074.zip" class="aui-list-checked aui-list-item-link" title="Download all attachments as a ZIP file"><span>Download All</span></a></li></ul></div></div></li></ul><h2 class="toggle-title">Attachments</h2></div><div class="mod-content">
            <ol id="file_attachments" class="item-attachments">
                            <li class="attachment-content">
                                            <div class="twixi-block collapsed">
                            <div class="twixi-wrap verbose">
                                <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
                                <div class="attachment-thumb">
                                    <a href="attachment/18363/$%7BfileAttachment.fileNameUrlEncoded%7D" draggable="true" data-downloadurl="application/zip:NanoWarOptionalSession.zip:attachment/18363/NanoWarOptionalSession.zip">
                                            <img src="index_files/zip.gif" alt="Zip Archive" height="16" border="0" width="16">
                                    </a>
                                </div>
                                <dl>
                                        <dt class="attachment-title">
        <a href="attachment/18363/NanoWarOptionalSession.zip" title="Latest  30/Dec/05 2:19 PM - Michael Rimov" draggable="true" data-downloadurl="application/zip:NanoWarOptionalSession.zip:attachment/18363/NanoWarOptionalSession.zip">NanoWarOptionalSession.zip
        </a>
    </dt>
    <dd class="attachment-delete">
                    <span class="icon"></span>
            </dd>
    <dd class="attachment-date"><time class="livestamp" datetime="2005-12-30T14:19-0600">30/Dec/05 2:19 PM</time></dd>
    <dd class="attachment-size">9 kB</dd>
    <dd class="attachment-author">Michael Rimov</dd>
                                    <dd class="zip-contents">
                                        <ol>
                                                                                                                                                <li>
                                                        <div class="attachment-thumb">
                                                            <a href="attachmentzip/unzip/22074/18363%5B0%5D/NanoWarOptionalSession/OptionalContextPatch.diff" draggable="true" data-downloadurl="${zipEntry.mimetype}:NanoWarOptionalSession/OptionalContextPatch.diff:attachmentzip/unzip/22074/18363%5B0%5D/NanoWarOptionalSession/OptionalContextPatch.diff">
                                                                    <img src="index_files/file.gif" alt="File" height="16" border="0" width="16">
                                                            </a>
                                                        </div>
                                                        <a href="attachmentzip/unzip/22074/18363%5B0%5D/NanoWarOptionalSession/OptionalContextPatch.diff" title="NanoWarOptionalSession/OptionalContextPatch.diff" draggable="true" data-downloadurl="${zipEntry.mimetype}:NanoWarOptionalSession/OptionalContextPatch.diff:attachmentzip/unzip/22074/18363%5B0%5D/NanoWarOptionalSession/OptionalContextPatch.diff">
                                                            NanoWarOptionalSession/OptionalContextPatch.diff
                                                        </a>
                                                        <span class="attachment-size">
                                                            15 kB
                                                        </span>
                                                    </li>
                                                                                                                                                                                                <li>
                                                        <div class="attachment-thumb">
                                                            <a href="attachmentzip/unzip/22074/18363%5B6%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java" draggable="true" data-downloadurl="text/plain:NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java:attachmentzip/unzip/22074/18363%5B6%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java">
                                                                    <img src="index_files/java.gif" alt="Java Source File" height="16" border="0" width="16">
                                                            </a>
                                                        </div>
                                                        <a href="attachmentzip/unzip/22074/18363%5B6%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java" title="NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java" draggable="true" data-downloadurl="text/plain:NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java:attachmentzip/unzip/22074/18363%5B6%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/AbstractNanoListener.java">
                                                            NanoWarOptionalSession/.../AbstractNanoListener.java
                                                        </a>
                                                        <span class="attachment-size">
                                                            1 kB
                                                        </span>
                                                    </li>
                                                                                                                                                                                                <li>
                                                        <div class="attachment-thumb">
                                                            <a href="attachmentzip/unzip/22074/18363%5B7%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java" draggable="true" data-downloadurl="text/plain:NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java:attachmentzip/unzip/22074/18363%5B7%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java">
                                                                    <img src="index_files/java.gif" alt="Java Source File" height="16" border="0" width="16">
                                                            </a>
                                                        </div>
                                                        <a href="attachmentzip/unzip/22074/18363%5B7%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java" title="NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java" draggable="true" data-downloadurl="text/plain:NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java:attachmentzip/unzip/22074/18363%5B7%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarContextListener.java">
                                                            NanoWarOptionalSession/.../NanoWarContextListener.java
                                                        </a>
                                                        <span class="attachment-size">
                                                            7 kB
                                                        </span>
                                                    </li>
                                                                                                                                                                                                <li>
                                                        <div class="attachment-thumb">
                                                            <a href="attachmentzip/unzip/22074/18363%5B8%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java" draggable="true" data-downloadurl="text/plain:NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java:attachmentzip/unzip/22074/18363%5B8%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java">
                                                                    <img src="index_files/java.gif" alt="Java Source File" height="16" border="0" width="16">
                                                            </a>
                                                        </div>
                                                        <a href="attachmentzip/unzip/22074/18363%5B8%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java" title="NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java" draggable="true" data-downloadurl="text/plain:NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java:attachmentzip/unzip/22074/18363%5B8%5D/NanoWarOptionalSession/src/java/org/nanocontainer/nanowar/NanoWarSessionListener.java">
                                                            NanoWarOptionalSession/.../NanoWarSessionListener.java
                                                        </a>
                                                        <span class="attachment-size">
                                                            4 kB
                                                        </span>
                                                    </li>
                                                                                                                                    </ol>
                                        <span class="zip-contents-trailer">
                                                                                        <a href="attachment/18363/NanoWarOptionalSession.zip" draggable="true" data-downloadurl="application/zip:NanoWarOptionalSession.zip:attachment/18363/${fileAttachment.fileNameUrlEncoded}">Download Zip</a>
                                        </span>
                                    </dd>
                                </dl>
                            </div>
                            <div class="twixi-wrap concise">
                                <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>

                                <div class="attachment-thumb">
                                    <a href="attachment/18363/NanoWarOptionalSession.zip" draggable="true" data-downloadurl="application/zip:NanoWarOptionalSession.zip:attachment/18363/NanoWarOptionalSession.zip">
                                            <img src="index_files/zip.gif" alt="Zip Archive" height="16" border="0" width="16">
                                    </a>
                                </div>
                                <dl>
                                        <dt class="attachment-title">
        <a href="attachment/18363/NanoWarOptionalSession.zip" title="Latest  30/Dec/05 2:19 PM - Michael Rimov" draggable="true" data-downloadurl="application/zip:NanoWarOptionalSession.zip:attachment/18363/NanoWarOptionalSession.zip">NanoWarOptionalSession.zip
        </a>
    </dt>
    <dd class="attachment-delete">
                    <span class="icon"></span>
            </dd>
    <dd class="attachment-date"><time class="livestamp" datetime="2005-12-30T14:19-0600">30/Dec/05 2:19 PM</time></dd>
    <dd class="attachment-size">9 kB</dd>
    <dd class="attachment-author">Michael Rimov</dd>
                                </dl>
                            </div>
                        </div>
                                    </li>
                            <li class="attachment-content">
                                            <div class="twixi-block collapsed">
                            <div class="twixi-wrap verbose">
                                <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
                                <div class="attachment-thumb">
                                    <a href="attachment/14226/$%7BfileAttachment.fileNameUrlEncoded%7D" draggable="true" data-downloadurl="application/zip:nanowar-session-serialization.zip:attachment/14226/nanowar-session-serialization.zip">
                                            <img src="index_files/zip.gif" alt="Zip Archive" height="16" border="0" width="16">
                                    </a>
                                </div>
                                <dl>
                                        <dt class="attachment-title">
        <a href="attachment/14226/nanowar-session-serialization.zip" title="Latest  08/Apr/05 11:02 AM - James Mead" draggable="true" data-downloadurl="application/zip:nanowar-session-serialization.zip:attachment/14226/nanowar-session-serialization.zip">nanowar-session-serialization.zip
        </a>
    </dt>
    <dd class="attachment-delete">
                    <span class="icon"></span>
            </dd>
    <dd class="attachment-date"><time class="livestamp" datetime="2005-04-08T11:02-0500">08/Apr/05 11:02 AM</time></dd>
    <dd class="attachment-size">9 kB</dd>
    <dd class="attachment-author">James Mead</dd>
                                    <dd class="zip-contents">
                                        <ol>
                                                                                                                                                <li>
                                                        <div class="attachment-thumb">
                                                            <a href="attachmentzip/unzip/22074/14226%5B0%5D/Documents%20and%20Settings/jmead/Desktop/new-classes.zip" draggable="true" data-downloadurl="application/zip:Documents and Settings/jmead/Desktop/new-classes.zip:attachmentzip/unzip/22074/14226%5B0%5D/Documents and Settings/jmead/Desktop/new-classes.zip">
                                                                    <img src="index_files/zip.gif" alt="Zip Archive" height="16" border="0" width="16">
                                                            </a>
                                                        </div>
                                                        <a href="attachmentzip/unzip/22074/14226%5B0%5D/Documents%20and%20Settings/jmead/Desktop/new-classes.zip" title="Documents and Settings/jmead/Desktop/new-classes.zip" draggable="true" data-downloadurl="application/zip:Documents and Settings/jmead/Desktop/new-classes.zip:attachmentzip/unzip/22074/14226%5B0%5D/Documents and Settings/jmead/Desktop/new-classes.zip">
                                                            Documents and Settings/.../new-classes.zip
                                                        </a>
                                                        <span class="attachment-size">
                                                            7 kB
                                                        </span>
                                                    </li>
                                                                                                                                                                                                <li>
                                                        <div class="attachment-thumb">
                                                            <a href="attachmentzip/unzip/22074/14226%5B1%5D/Documents%20and%20Settings/jmead/Desktop/modified.patch" draggable="true" data-downloadurl="${zipEntry.mimetype}:Documents and Settings/jmead/Desktop/modified.patch:attachmentzip/unzip/22074/14226%5B1%5D/Documents and Settings/jmead/Desktop/modified.patch">
                                                                    <img src="index_files/text.gif" alt="Text File" height="16" border="0" width="16">
                                                            </a>
                                                        </div>
                                                        <a href="attachmentzip/unzip/22074/14226%5B1%5D/Documents%20and%20Settings/jmead/Desktop/modified.patch" title="Documents and Settings/jmead/Desktop/modified.patch" draggable="true" data-downloadurl="${zipEntry.mimetype}:Documents and Settings/jmead/Desktop/modified.patch:attachmentzip/unzip/22074/14226%5B1%5D/Documents and Settings/jmead/Desktop/modified.patch">
                                                            Documents and Settings/.../modified.patch
                                                        </a>
                                                        <span class="attachment-size">
                                                            5 kB
                                                        </span>
                                                    </li>
                                                                                                                                    </ol>
                                        <span class="zip-contents-trailer">
                                                                                        <a href="attachment/14226/nanowar-session-serialization.zip" draggable="true" data-downloadurl="application/zip:nanowar-session-serialization.zip:attachment/14226/${fileAttachment.fileNameUrlEncoded}">Download Zip</a>
                                        </span>
                                    </dd>
                                </dl>
                            </div>
                            <div class="twixi-wrap concise">
                                <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>

                                <div class="attachment-thumb">
                                    <a href="attachment/14226/nanowar-session-serialization.zip" draggable="true" data-downloadurl="application/zip:nanowar-session-serialization.zip:attachment/14226/nanowar-session-serialization.zip">
                                            <img src="index_files/zip.gif" alt="Zip Archive" height="16" border="0" width="16">
                                    </a>
                                </div>
                                <dl>
                                        <dt class="attachment-title">
        <a href="attachment/14226/nanowar-session-serialization.zip" title="Latest  08/Apr/05 11:02 AM - James Mead" draggable="true" data-downloadurl="application/zip:nanowar-session-serialization.zip:attachment/14226/nanowar-session-serialization.zip">nanowar-session-serialization.zip
        </a>
    </dt>
    <dd class="attachment-delete">
                    <span class="icon"></span>
            </dd>
    <dd class="attachment-date"><time class="livestamp" datetime="2005-04-08T11:02-0500">08/Apr/05 11:02 AM</time></dd>
    <dd class="attachment-size">9 kB</dd>
    <dd class="attachment-author">James Mead</dd>
                                </dl>
                            </div>
                        </div>
                                    </li>
                    </ol>
        </div></div><div id="activitymodule" class="module toggle-wrap"><div id="activitymodule_heading" class="mod-header"><ul class="ops"></ul><h2 class="toggle-title">Activity</h2></div><div class="mod-content">










    <div class="tabwrap tabs2" style="display:none">
                    <div class="sortwrap">
                                    <a class="icon icon-sort-down ajax-activity-content" rel="nofollow" href="index.htmlWAR-15?actionOrder=desc" title="Ascending order - Click to sort in descending order"><span>Ascending order - Click to sort in descending order</span></a>
                            </div>
                <ul id="issue-tabs" class="tabs horizontal">
                                
            <li class="active" id="all-tabpanel" data-id="all-tabpanel" data-key="com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel" data-label="All" data-href="/browse/NANOWAR-15">
                            <strong>All</strong>
                        </li>
                                
            <li data-id="comment-tabpanel" data-key="com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel" data-label="Comments" data-href="/browse/NANOWAR-15">
                            <a class="ajax-activity-content" id="comment-tabpanel" href="index.htmlWAR-15"><strong>Comments</strong></a>
                        </li>
                                
            <li data-id="worklog-tabpanel" data-key="com.atlassian.jira.plugin.system.issuetabpanels:worklog-tabpanel" data-label="Work Log" data-href="/browse/NANOWAR-15">
                            <a class="ajax-activity-content" id="worklog-tabpanel" href="index.htmlWAR-15"><strong>Work Log</strong></a>
                        </li>
                                
            <li data-id="changehistory-tabpanel" data-key="com.atlassian.jira.plugin.system.issuetabpanels:changehistory-tabpanel" data-label="History" data-href="/browse/NANOWAR-15">
                            <a class="ajax-activity-content" id="changehistory-tabpanel" href="index.htmlWAR-15"><strong>History</strong></a>
                        </li>
                                
            <li data-id="activity-stream-issue-tab" data-key="com.atlassian.streams.streams-jira-plugin:activity-stream-issue-tab" data-label="Activity" data-href="/browse/NANOWAR-15">
                            <a class="ajax-activity-content" id="activity-stream-issue-tab" href="index.htmlWAR-15"><strong>Activity</strong></a>
                        </li>
                </ul>
    </div>
    <div class="issuePanelWrapper">
        <div class="issuePanelProgress"></div>
        <div class="issuePanelContainer" id="issue_actions_container">
                                    


<div id="comment-31737" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=31737&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-31737" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="jamesmead" id="commentauthor_31737_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=jamesmead"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> James Mead</a>
 added a comment  - <span class="commentdate_31737_verbose subText"><span class="date user-tz" title="08/Apr/05 11:07 AM"><time class="livestamp" datetime="2005-04-08T11:07-0500">08/Apr/05 11:07 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>I've just realised there may be a problem with my suggested fix - my modification to ServletContainerListener is WebWork specific - it uses a new class (ApplicationScopeViaActionContextObjectReference) which uses WebWork's ActionContext. </p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="jamesmead" id="commentauthor_31737_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=jamesmead"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> James Mead</a>
 added a comment  - <span class="commentdate_31737_concise subText"><span class="date user-tz" title="08/Apr/05 11:07 AM"><time class="livestamp" datetime="2005-04-08T11:07-0500">08/Apr/05 11:07 AM</time></span></span>                    I've just realised there may be a problem with my suggested fix - my modification to ServletContainerListener is WebWork specific - it uses a new class (ApplicationScopeViaActionContextObjectReference) which uses WebWork's ActionContext.               </div>
        </div>
    </div>
</div>
                             


<div id="comment-31842" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=31842&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-31842" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_31842_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_31842_verbose subText"><span class="date user-tz" title="11/Apr/05 8:22 AM"><time class="livestamp" datetime="2005-04-11T08:22-0500">11/Apr/05 8:22 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Hi James, </p>

<p>this is not really a Pico bug - but a Nano one. </p>

<p>Also, the factory implementation you provide is completely<br>
static driven - which is the evil of IoC. <br>
Moreover, it could probably all sit in nanowar component.<br>
If you feel there is functionality in Pico that is required<br>
then best file an issue for Pico only.</p>

<p>Could you have a go at refactoring it along these lines<br>
and open a new issue on <a href="http://jira.codehaus.org/browse/NANO" class="external-link" rel="nofollow">http://jira.codehaus.org/browse/NANO</a><br>
with the new CVS patch?</p>

<p>Thanks,<br>
Mauro</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_31842_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_31842_concise subText"><span class="date user-tz" title="11/Apr/05 8:22 AM"><time class="livestamp" datetime="2005-04-11T08:22-0500">11/Apr/05 8:22 AM</time></span></span>                    Hi James,  

 this is not really a Pico bug - but a Nano one.  

 Also, the factory implementation you provide is completely 
static driven - which is the evil of IoC.  
Moreover, it could probably all sit in nanowar component. 
If you feel there is functionality in Pico that is required 
then best file an issue for Pico only. 

 Could you have a go at refactoring it along these lines 
and open a new issue on  http://jira.codehaus.org/browse/NANO  
with the new CVS patch? 

 Thanks, 
Mauro              </div>
        </div>
    </div>
</div>
                             

<div class="issue-data-block" id="changehistory-34795">
    <div class="actionContainer">
        <div class="action-details" id="changehistorydetails_34795">
                                

    <a class="user-hover user-avatar" rel="joehni" id="changehistoryauthor_34795" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 made changes  - <span class="date" title="11/Apr/05 8:30 AM"><time class="livestamp" datetime="2005-04-11T08:30-0500">11/Apr/05 8:30 AM</time></span>
        </div>
        <div class="changehistory action-body">
            <table id="changehistory_34795" border="0" cellpadding="0" cellspacing="0" width="100%">
                            <thead>
                    <tr>
                        <th width="20%">Field</th>
                        <th width="40%">Original Value</th>
                        <th width="40%">New Value</th>
                    </tr>
                </thead>
                            <tbody>
                            <tr>
                <td class="activity-name" width="20%">
                                    Affects Version/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                                1.1
                                                                                                <span class="hist-value">[    10307
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Key
                                </td>
                <td class="activity-old-val" width="40%">
                                                                <a href="#" title="Nanowar - session-scope serialization fails if app-scope container is not serializable" class="issue-link" data-issue-key="NANOWAR-15">PICO-230</a>
                                                                    </td>
                <td class="activity-new-val" width="40%">
                                                               <a href="#" title="Nanowar - session-scope serialization fails if app-scope container is not serializable" class="issue-link" data-issue-key="NANOWAR-15">NANO-133</a>
                                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Component/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                               nanowar
                                                                                               <span class="hist-value">[    10970
]</span>
                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Component/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                                PicoContainer (Java)
                                                                                                <span class="hist-value">[    10191
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Project
                                </td>
                <td class="activity-old-val" width="40%">
                                                                PicoContainer
                                                                                                <span class="hist-value">[    10120
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                               NanoContainer
                                                                                               <span class="hist-value">[    10121
]</span>
                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Affects Version/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                               1.0-beta-5
                                                                                               <span class="hist-value">[    11369
]</span>
                                                    </td>
                </tr>
                            </tbody>
            </table>
        </div>
    </div>
</div>
                             


<div id="comment-31844" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=31844&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-31844" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="joehni" id="commentauthor_31844_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 added a comment  - <span class="commentdate_31844_verbose subText"><span class="date user-tz" title="11/Apr/05 8:31 AM"><time class="livestamp" datetime="2005-04-11T08:31-0500">11/Apr/05 8:31 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Done with JIRA.</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="joehni" id="commentauthor_31844_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 added a comment  - <span class="commentdate_31844_concise subText"><span class="date user-tz" title="11/Apr/05 8:31 AM"><time class="livestamp" datetime="2005-04-11T08:31-0500">11/Apr/05 8:31 AM</time></span></span>                    Done with JIRA.              </div>
        </div>
    </div>
</div>
                             

<div class="issue-data-block" id="changehistory-40355">
    <div class="actionContainer">
        <div class="action-details" id="changehistorydetails_40355">
                                

    <a class="user-hover user-avatar" rel="maurotalevi" id="changehistoryauthor_40355" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 made changes  - <span class="date" title="11/Jun/05 11:49 AM"><time class="livestamp" datetime="2005-06-11T11:49-0500">11/Jun/05 11:49 AM</time></span>
        </div>
        <div class="changehistory action-body">
            <table id="changehistory_40355" border="0" cellpadding="0" cellspacing="0" width="100%">
                            <tbody>
                            <tr>
                <td class="activity-name" width="20%">
                                    Project
                                </td>
                <td class="activity-old-val" width="40%">
                                                                NanoContainer
                                                                                                <span class="hist-value">[    10121
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                               NanoWar
                                                                                               <span class="hist-value">[    11001
]</span>
                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Component/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                                nanowar
                                                                                                <span class="hist-value">[    10970
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Component/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                               core
                                                                                               <span class="hist-value">[    11625
]</span>
                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Affects Version/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                                1.0-beta-5
                                                                                                <span class="hist-value">[    11369
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Key
                                </td>
                <td class="activity-old-val" width="40%">
                                                                <a href="#" title="Nanowar - session-scope serialization fails if app-scope container is not serializable" class="issue-link" data-issue-key="NANOWAR-15">NANO-133</a>
                                                                    </td>
                <td class="activity-new-val" width="40%">
                                                               <a href="#" title="Nanowar - session-scope serialization fails if app-scope container is not serializable" class="issue-link" data-issue-key="NANOWAR-15">NANOWAR-15</a>
                                                                    </td>
                </tr>
                            </tbody>
            </table>
        </div>
    </div>
</div>
                             

<div class="issue-data-block" id="changehistory-40419">
    <div class="actionContainer">
        <div class="action-details" id="changehistorydetails_40419">
                                

    <a class="user-hover user-avatar" rel="maurotalevi" id="changehistoryauthor_40419" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 made changes  - <span class="date" title="12/Jun/05 6:42 AM"><time class="livestamp" datetime="2005-06-12T06:42-0500">12/Jun/05 6:42 AM</time></span>
        </div>
        <div class="changehistory action-body">
            <table id="changehistory_40419" border="0" cellpadding="0" cellspacing="0" width="100%">
                            <tbody>
                            <tr>
                <td class="activity-name" width="20%">
                                    Environment
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Fix Version/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                               1.0
                                                                                               <span class="hist-value">[    11801
]</span>
                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Description
                                </td>
                <td class="activity-old-val" width="40%">
                                                                If the app-scope container is not serializable, then when the session-scope container is serialized by the app server (for fail-over, etc) - it attempts to serialize its parent (the app-scope container), but fails with a NotSerializableException.<br>
<br>
Here is a patch which fixes the problem by putting a wrapper around the app-scope container. The wrapper looks up the app-scope container in the servlet context each time it is needed. Because the only state in the wrapper is the app-scope container key, it can be successfully serialized.<br>
<br>
SessionSerializationIntegrationTestCase has a test to demonstrate the current problem and another test to demonstrate the fix.
                                                                    </td>
                <td class="activity-new-val" width="40%">
                                                               If the app-scope container is not serializable, then when the session-scope container is serialized by the app server (for fail-over, etc) - it attempts to serialize its parent (the app-scope container), but fails with a NotSerializableException.<br>
<br>
Here is a patch which fixes the problem by putting a wrapper around the app-scope container. The wrapper looks up the app-scope container in the servlet context each time it is needed. Because the only state in the wrapper is the app-scope container key, it can be successfully serialized.<br>
<br>
SessionSerializationIntegrationTestCase has a test to demonstrate the current problem and another test to demonstrate the fix.
                                                                    </td>
                </tr>
                            </tbody>
            </table>
        </div>
    </div>
</div>
                             


<div id="comment-46988" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=46988&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-46988" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_46988_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_46988_verbose subText"><span class="date user-tz" title="23/Sep/05 7:16 AM"><time class="livestamp" datetime="2005-09-23T07:16-0500">23/Sep/05 7:16 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Should we simply require all containers to be consistent with serialisation?</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_46988_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_46988_concise subText"><span class="date user-tz" title="23/Sep/05 7:16 AM"><time class="livestamp" datetime="2005-09-23T07:16-0500">23/Sep/05 7:16 AM</time></span></span>                    Should we simply require all containers to be consistent with serialisation?              </div>
        </div>
    </div>
</div>
                             


<div id="comment-46989" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=46989&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-46989" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="joehni" id="commentauthor_46989_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 added a comment  - <span class="commentdate_46989_verbose subText"><span class="date user-tz" title="23/Sep/05 7:22 AM"><time class="livestamp" datetime="2005-09-23T07:22-0500">23/Sep/05 7:22 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Normally a container hierarchy should be serializable. The funny part starts when there's a need for serializing only a child container, but not its parent. Normally this is a security issue, since you can use this mechanism to move parts of a container hierarchy onto a new root container ...</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="joehni" id="commentauthor_46989_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 added a comment  - <span class="commentdate_46989_concise subText"><span class="date user-tz" title="23/Sep/05 7:22 AM"><time class="livestamp" datetime="2005-09-23T07:22-0500">23/Sep/05 7:22 AM</time></span></span>                    Normally a container hierarchy should be serializable. The funny part starts when there's a need for serializing only a child container, but not its parent. Normally this is a security issue, since you can use this mechanism to move parts of a container hierarchy onto a new root container ...              </div>
        </div>
    </div>
</div>
                             


<div id="comment-46993" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=46993&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-46993" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="paul" id="commentauthor_46993_verbose" href="https://github.com/paul-hammant"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Paul Hammant</a>
 added a comment  - <span class="commentdate_46993_verbose subText"><span class="date user-tz" title="23/Sep/05 7:58 AM"><time class="livestamp" datetime="2005-09-23T07:58-0500">23/Sep/05 7:58 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Or have a second listener that exists solely to support non-serializable ones, or ones where serialization is chosen not to happen (bad Inglish sorry)</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="paul" id="commentauthor_46993_concise" href="https://github.com/paul-hammant"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Paul Hammant</a>
 added a comment  - <span class="commentdate_46993_concise subText"><span class="date user-tz" title="23/Sep/05 7:58 AM"><time class="livestamp" datetime="2005-09-23T07:58-0500">23/Sep/05 7:58 AM</time></span></span>                    Or have a second listener that exists solely to support non-serializable ones, or ones where serialization is chosen not to happen (bad Inglish sorry)              </div>
        </div>
    </div>
</div>
                             


<div id="comment-47028" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=47028&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-47028" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_47028_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_47028_verbose subText"><span class="date user-tz" title="23/Sep/05 2:30 PM"><time class="livestamp" datetime="2005-09-23T14:30-0500">23/Sep/05 2:30 PM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>The idea of a separate listener is good - as it keeps behaviour consistent<br>
and the functionality can be implemented as additional functionality.<br>
That said, I'm tempted to put this issue on the backburner (ie post 1.0 release),<br>
as I fail to see a pressing usecase for the scenario of inconsistent serialisation.</p>

<p>If anybody sees the urgency for it, please shout.</p>

 </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_47028_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_47028_concise subText"><span class="date user-tz" title="23/Sep/05 2:30 PM"><time class="livestamp" datetime="2005-09-23T14:30-0500">23/Sep/05 2:30 PM</time></span></span>                    The idea of a separate listener is good - as it keeps behaviour consistent 
and the functionality can be implemented as additional functionality. 
That said, I'm tempted to put this issue on the backburner (ie post 1.0 release), 
as I fail to see a pressing usecase for the scenario of inconsistent serialisation. 

 If anybody sees the urgency for it, please shout. 

             </div>
        </div>
    </div>
</div>
                             


<div id="comment-47070" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=47070&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-47070" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="paul" id="commentauthor_47070_verbose" href="https://github.com/paul-hammant"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Paul Hammant</a>
 added a comment  - <span class="commentdate_47070_verbose subText"><span class="date user-tz" title="24/Sep/05 8:02 AM"><time class="livestamp" datetime="2005-09-24T08:02-0500">24/Sep/05 8:02 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Bumped to 1.1, Alternate Listener to be added after 1.0 release</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="paul" id="commentauthor_47070_concise" href="https://github.com/paul-hammant"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Paul Hammant</a>
 added a comment  - <span class="commentdate_47070_concise subText"><span class="date user-tz" title="24/Sep/05 8:02 AM"><time class="livestamp" datetime="2005-09-24T08:02-0500">24/Sep/05 8:02 AM</time></span></span>                    Bumped to 1.1, Alternate Listener to be added after 1.0 release              </div>
        </div>
    </div>
</div>
                             

<div class="issue-data-block" id="changehistory-50826">
    <div class="actionContainer">
        <div class="action-details" id="changehistorydetails_50826">
                                

    <a class="user-hover user-avatar" rel="paul" id="changehistoryauthor_50826" href="https://github.com/paul-hammant"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Paul Hammant</a>
 made changes  - <span class="date" title="24/Sep/05 8:02 AM"><time class="livestamp" datetime="2005-09-24T08:02-0500">24/Sep/05 8:02 AM</time></span>
        </div>
        <div class="changehistory action-body">
            <table id="changehistory_50826" border="0" cellpadding="0" cellspacing="0" width="100%">
                            <tbody>
                            <tr>
                <td class="activity-name" width="20%">
                                    Fix Version/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                                1.0
                                                                                                <span class="hist-value">[    11801
]</span>
                                                    </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Environment
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Fix Version/s
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                               1.1
                                                                                               <span class="hist-value">[    12014
]</span>
                                                    </td>
                </tr>
                            <tr>
                <td class="activity-name" width="20%">
                                    Description
                                </td>
                <td class="activity-old-val" width="40%">
                                                                If the app-scope container is not serializable, then when the session-scope container is serialized by the app server (for fail-over, etc) - it attempts to serialize its parent (the app-scope container), but fails with a NotSerializableException.<br>
<br>
Here is a patch which fixes the problem by putting a wrapper around the app-scope container. The wrapper looks up the app-scope container in the servlet context each time it is needed. Because the only state in the wrapper is the app-scope container key, it can be successfully serialized.<br>
<br>
SessionSerializationIntegrationTestCase has a test to demonstrate the current problem and another test to demonstrate the fix.
                                                                    </td>
                <td class="activity-new-val" width="40%">
                                                               If the app-scope container is not serializable, then when the session-scope container is serialized by the app server (for fail-over, etc) - it attempts to serialize its parent (the app-scope container), but fails with a NotSerializableException.<br>
<br>
Here is a patch which fixes the problem by putting a wrapper around the app-scope container. The wrapper looks up the app-scope container in the servlet context each time it is needed. Because the only state in the wrapper is the app-scope container key, it can be successfully serialized.<br>
<br>
SessionSerializationIntegrationTestCase has a test to demonstrate the current problem and another test to demonstrate the fix.
                                                                    </td>
                </tr>
                            </tbody>
            </table>
        </div>
    </div>
</div>
                             


<div id="comment-54363" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=54363&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-54363" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_54363_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_54363_verbose subText"><span class="date user-tz" title="28/Dec/05 12:07 PM"><time class="livestamp" datetime="2005-12-28T12:07-0600">28/Dec/05 12:07 PM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Actually, I think this is a worse issue  the Application level container should NOT be getting serialized with the session at all! (IMO). Just posted about this on the listserv.  In short the issues are:</p>

<p>Session serialization of app container will result in:<br>
   -serialization of entire container hierarchy in clustered environments.<br>
   -Inconsistent container hierarchy in stop/start environments where the session is persisted across app restarts.</p>


 </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_54363_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_54363_concise subText"><span class="date user-tz" title="28/Dec/05 12:07 PM"><time class="livestamp" datetime="2005-12-28T12:07-0600">28/Dec/05 12:07 PM</time></span></span>                    Actually, I think this is a worse issue  the Application level container should NOT be getting serialized with the session at all! (IMO). Just posted about this on the listserv.  In short the issues are: 

 Session serialization of app container will result in: 
   -serialization of entire container hierarchy in clustered environments. 
   -Inconsistent container hierarchy in stop/start environments where the session is persisted across app restarts. 


             </div>
        </div>
    </div>
</div>
                             


<div id="comment-54569" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=54569&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-54569" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_54569_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_54569_verbose subText"><span class="date user-tz" title="30/Dec/05 2:19 PM"><time class="livestamp" datetime="2005-12-30T14:19-0600">30/Dec/05 2:19 PM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>The following patch makes Session integration optional.  For those that need it (Tomcat users in particular), you can work around the session problems by eliminating them alltogether.  Instead of ServletContainerListener, use NanoWarContextListener instead. </p>

<p>Also, NanoWarSessionListener + NanoWarContextListener ='s ServletContainerListener.</p>

<p>Should be backwards compatible.</p>

<p>-Mike (R)</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_54569_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_54569_concise subText"><span class="date user-tz" title="30/Dec/05 2:19 PM"><time class="livestamp" datetime="2005-12-30T14:19-0600">30/Dec/05 2:19 PM</time></span></span>                    The following patch makes Session integration optional.  For those that need it (Tomcat users in particular), you can work around the session problems by eliminating them alltogether.  Instead of ServletContainerListener, use NanoWarContextListener instead.  

 Also, NanoWarSessionListener + NanoWarContextListener ='s ServletContainerListener. 

 Should be backwards compatible. 

 -Mike (R)              </div>
        </div>
    </div>
</div>
                             

<div class="issue-data-block" id="changehistory-61952">
    <div class="actionContainer">
        <div class="action-details" id="changehistorydetails_61952">
                                

    <a class="user-hover user-avatar" rel="rimovm" id="changehistoryauthor_61952" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 made changes  - <span class="date" title="30/Dec/05 2:19 PM"><time class="livestamp" datetime="2005-12-30T14:19-0600">30/Dec/05 2:19 PM</time></span>
        </div>
        <div class="changehistory action-body">
            <table id="changehistory_61952" border="0" cellpadding="0" cellspacing="0" width="100%">
                            <tbody>
                            <tr>
                <td class="activity-name" width="20%">
                                    Attachment
                                </td>
                <td class="activity-old-val" width="40%">
                                                </td>
                <td class="activity-new-val" width="40%">
                                                                                        <a href="attachment/18363/NanoWarOptionalSession.zip">NanoWarOptionalSession.zip</a>
                                                                                                                       <span class="hist-value">[    18363
]</span>
                                                    </td>
                </tr>
                            </tbody>
            </table>
        </div>
    </div>
</div>
                             


<div id="comment-54571" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=54571&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-54571" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_54571_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_54571_verbose subText"><span class="date user-tz" title="30/Dec/05 2:26 PM"><time class="livestamp" datetime="2005-12-30T14:26-0600">30/Dec/05 2:26 PM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>I think that the permanent fix should be splitting the constant parent/child hierarchies so that session is not permanently a child of application.</p>

<p>Instead, it should be wired together for only the duration of a Request.  So the request filter would:</p>

<p>1 - Grab Application Level Container.<br>
2 - Grab <em>detached</em> session level container.<br>
3 - Build request-level container.</p>

<p>Somehow hook into the whole mess so that any requests for parent.getComponent*() in the request container would propagate to the detached session container, and if it propages further, then query the app level container.</p>

<p>At first I thought that we could just have the request filter register the session container with the app container and the request with the session at the beginning of the request, and deregister them at the end of the request.  However, I realized that each registration would cause a whole new transmission of the session container over the wire in a clustered environment (including once again attempting a transmission of the app level container).</p>

<p>Does pico have anything that we could do this with?  Would a proxy work so the request filter could intercept any calls to the parent pico and propagate it up to the next container?</p>


<p>-Mike (R)</p>
 </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_54571_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_54571_concise subText"><span class="date user-tz" title="30/Dec/05 2:26 PM"><time class="livestamp" datetime="2005-12-30T14:26-0600">30/Dec/05 2:26 PM</time></span></span>                    I think that the permanent fix should be splitting the constant parent/child hierarchies so that session is not permanently a child of application. 

 Instead, it should be wired together for only the duration of a Request.  So the request filter would: 

 1 - Grab Application Level Container. 
2 - Grab  detached  session level container. 
3 - Build request-level container. 

 Somehow hook into the whole mess so that any requests for parent.getComponent*() in the request container would propagate to the detached session container, and if it propages further, then query the app level container. 

 At first I thought that we could just have the request filter register the session container with the app container and the request with the session at the beginning of the request, and deregister them at the end of the request.  However, I realized that each registration would cause a whole new transmission of the session container over the wire in a clustered environment (including once again attempting a transmission of the app level container). 

 Does pico have anything that we could do this with?  Would a proxy work so the request filter could intercept any calls to the parent pico and propagate it up to the next container? 


 -Mike (R) 
             </div>
        </div>
    </div>
</div>
                             


<div id="comment-56087" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=56087&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-56087" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_56087_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_56087_verbose subText"><span class="date user-tz" title="17/Jan/06 7:39 AM"><time class="livestamp" datetime="2006-01-17T07:39-0600">17/Jan/06 7:39 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Applied patch as a fix for release 1.0.  A comprehensive solution is due for release 1.1.</p>
 </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="maurotalevi" id="commentauthor_56087_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=maurotalevi"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Mauro Talevi</a>
 added a comment  - <span class="commentdate_56087_concise subText"><span class="date user-tz" title="17/Jan/06 7:39 AM"><time class="livestamp" datetime="2006-01-17T07:39-0600">17/Jan/06 7:39 AM</time></span></span>                    Applied patch as a fix for release 1.0.  A comprehensive solution is due for release 1.1. 
             </div>
        </div>
    </div>
</div>
                             


<div id="comment-56670" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=56670&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-56670" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_56670_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_56670_verbose subText"><span class="date user-tz" title="23/Jan/06 12:33 PM"><time class="livestamp" datetime="2006-01-23T12:33-0600">23/Jan/06 12:33 PM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Ok, here's my first stab at designing a solution.   We want the same hierarchial container behavior without the explicit references from child to parent to allow for efficient serialization:</p>

<p>Solution #1:</p>

<p>Step 1:  Modify MutablePicoContainer by adding:</p>

<p>/**<br>
    Implementations should be synchronized.<br>
    @param parent:  A parent container, may be null if no parent is desired.<br>
*/<br>
void setParent(PicoContainer parent);   </p>


<p>Step 2: Create new MutablePicoContainer: TransientParentPicoContainer.    The parent reference is transient so changes won't necessarily mean serialization across the network.  </p>

<p>Step 3:  Add class gems.AggregatePicoContainer.</p>

<p>public class AggregatePicoContainer() implements Startable {<br>
     private MutablePicoContainer[] hierarchy;</p>

<p>      //<br>
     // hierarchy<span class="error">[0]</span> is topmost parent, hierarchy<span class="error">[hierarchy.lengh - 1]</span> is deepest child container.<br>
     public AggregatePicoContainer(MutablePicoContainer[] hierarchy) </p>
{
             this.hierarchy = hierarchy;       
      }

<p>     //Implementation of pico methods<br>
     public Object getComponentInstance(Object key) </p>
{
                 return hierarchy[hierarchy.length - 1].getComponentInstance(key);
      }

<p>      //Other methods here.</p>

<p>     public void start() </p>
{
             wireHiearchyTogether();
     }

<p>     public void stop() </p>
{
              breakHierarchy();
    }


<p>    public void wireHierarchyTogether() {<br>
              for (int i =1 i &lt; hierarchy.length - 1; i++) </p>
{
                  hierarchy[i[.setParent(hierarchy[i-1]);
              }
<p>    }</p>

<p>    public void breakHierarchy() {<br>
              for (int i =1 i &lt; hierarchy.length - 1; i++) </p>
{
                  hierarchy[i[.setParent(null]);
                  hierarchy[i - 1].unregisterChildContainer(hierarchy[i]);
              }
<p>    }                 <br>
}</p>

<p>Step 4: Modify NanoWAR Request Filter To have the following steps:<br>
      -Build Request level NanoContainer Container.</p>
<ul class="alternate" type="square">
	<li>Create AggregatePicoContainer with Args <span class="error">[AppContainer, SessionContainer, RequestContainer]</span><br>
      -AggregatePicoContainer.start();<br>
      -Perform Rest of the request.<br>
       -AggregatePicoContainer.stop();</li>
</ul>



<p>Issues:<br>
In a clustered envrionment, session braodcast modules that aren't smart enough to recognize that a transient field is updated would still broadcast the session for each request, but at least no attempt to broadcast the app-level or request-level container would occur.  </p>

<p>So the end result is that for performant clustered environments, you still would want to skip the use of a session container.</p>

<p>In a non-clustered environment, this would work well.</p>

<p>Solution #2:</p>

<p>Provide parent references to the getComponent*() methods to the PicoContainer API like so:</p>

<p>Object getComponentInstance(Object key, PicoContainer parentCallback);  </p>

<p>Each time the container needed an object from its parent, it would call  if (parentCallback != null) parentCallback.getComponentInstance(key);</p>

<p>So each request for a parent container could be handled by the Aggregate picocontainer so it can work its way up a component hierarchy. </p>

<p>Disadvantages:  Much more complicated, it breaks the current concept of a clean picocontainer hierarchy, and would require a change to the Pico API.</p>

<p>Advantages:  There is no state change in the Session-level picocontainer so there would  be no over-the-wire transfers in clustered environments.  The calls to the aggregate picocontainer would stay the same from the client programmer, and yet the hierarchial behavior is still preserved.</p>

<p>So what do you think of these options?  Does anyone see any other way to get this proper behavior?</p>

<p>-Mike (R)</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_56670_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_56670_concise subText"><span class="date user-tz" title="23/Jan/06 12:33 PM"><time class="livestamp" datetime="2006-01-23T12:33-0600">23/Jan/06 12:33 PM</time></span></span>                    Ok, here's my first stab at designing a solution.   We want the same hierarchial container behavior without the explicit references from child to parent to allow for efficient serialization: 

 Solution #1: 

 Step 1:  Modify MutablePicoContainer by adding: 

 /** 
    Implementations should be synchronized. 
    @param parent:  A parent container, may be null if no parent is desired. 
*/ 
void setParent(PicoContainer parent);    


 Step 2: Create new MutablePicoContainer: TransientParentPicoContainer.    The parent reference is transient so changes won't necessarily mean serialization across the network.   

 Step 3:  Add class gems.AggregatePicoContainer. 

 public class AggregatePicoContainer() implements Startable { 
     private MutablePicoContainer[] hierarchy; 

       // 
     // hierarchy [0]  is topmost parent, hierarchy [hierarchy.lengh - 1]  is deepest child container. 
     public AggregatePicoContainer(MutablePicoContainer[] hierarchy)  
{
             this.hierarchy = hierarchy;       
      }

      //Implementation of pico methods 
     public Object getComponentInstance(Object key)  
{
                 return hierarchy[hierarchy.length - 1].getComponentInstance(key);
      }

       //Other methods here. 

      public void start()  
{
             wireHiearchyTogether();
     }

      public void stop()  
{
              breakHierarchy();
    }


     public void wireHierarchyTogether() { 
              for (int i =1 i &lt; hierarchy.length - 1; i++)  
{
                  hierarchy[i[.setParent(hierarchy[i-1]);
              }
     } 

     public void breakHierarchy() { 
              for (int i =1 i &lt; hierarchy.length - 1; i++)  
{
                  hierarchy[i[.setParent(null]);
                  hierarchy[i - 1].unregisterChildContainer(hierarchy[i]);
              }
     }                  
} 

 Step 4: Modify NanoWAR Request Filter To have the following steps: 
      -Build Request level NanoContainer Container. 
 
	 Create AggregatePicoContainer with Args  [AppContainer, SessionContainer, RequestContainer]  
      -AggregatePicoContainer.start(); 
      -Perform Rest of the request. 
       -AggregatePicoContainer.stop(); 
 



 Issues: 
In a clustered envrionment, session braodcast modules that aren't smart enough to recognize that a transient field is updated would still broadcast the session for each request, but at least no attempt to broadcast the app-level or request-level container would occur.   

 So the end result is that for performant clustered environments, you still would want to skip the use of a session container. 

 In a non-clustered environment, this would work well. 

 Solution #2: 

 Provide parent references to the getComponent*() methods to the PicoContainer API like so: 

 Object getComponentInstance(Object key, PicoContainer parentCallback);   

 Each time the container needed an object from its parent, it would call  if (parentCallback != null) parentCallback.getComponentInstance(key); 

 So each request for a parent container could be handled by the Aggregate picocontainer so it can work its way up a component hierarchy.  

 Disadvantages:  Much more complicated, it breaks the current concept of a clean picocontainer hierarchy, and would require a change to the Pico API. 

 Advantages:  There is no state change in the Session-level picocontainer so there would  be no over-the-wire transfers in clustered environments.  The calls to the aggregate picocontainer would stay the same from the client programmer, and yet the hierarchial behavior is still preserved. 

 So what do you think of these options?  Does anyone see any other way to get this proper behavior? 

 -Mike (R)              </div>
        </div>
    </div>
</div>
                             


<div id="comment-56736" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=56736&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-56736" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="joehni" id="commentauthor_56736_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 added a comment  - <span class="commentdate_56736_verbose subText"><span class="date user-tz" title="24/Jan/06 1:13 AM"><time class="livestamp" datetime="2006-01-24T01:13-0600">24/Jan/06 1:13 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>#1: see "svn diff -r 1376:1398 container/src/java/org/picocontainer/MutablePicoContainer.java"<br>
setParent was explicitly removed, since this can be used to compromise the security.<br>
#2: Too much API change</p>

<p>What's left? Try to use a TransientHotSwappingPicoContainerProxy. WDYT?</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="joehni" id="commentauthor_56736_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=joehni"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Jörg Schaible</a>
 added a comment  - <span class="commentdate_56736_concise subText"><span class="date user-tz" title="24/Jan/06 1:13 AM"><time class="livestamp" datetime="2006-01-24T01:13-0600">24/Jan/06 1:13 AM</time></span></span>                    #1: see "svn diff -r 1376:1398 container/src/java/org/picocontainer/MutablePicoContainer.java" 
setParent was explicitly removed, since this can be used to compromise the security. 
#2: Too much API change 

 What's left? Try to use a TransientHotSwappingPicoContainerProxy. WDYT?              </div>
        </div>
    </div>
</div>
                             


<div id="comment-56737" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=56737&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-56737" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_56737_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_56737_verbose subText"><span class="date user-tz" title="24/Jan/06 1:31 AM"><time class="livestamp" datetime="2006-01-24T01:31-0600">24/Jan/06 1:31 AM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Well, originally, I thought that maybe something like that would work, but I don't see any way of coping with it and session without somehow having a reference to a container's session which would cause us to be back at square one.</p>

<p>Perhaps I'm missing something and you could elaborate on how you'd use it ot keep strong references away from the session yet stil have the hiearchy?</p>

<p>Thanks for giving it some thought!</p>

<p>-Mike</p>


 </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_56737_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_56737_concise subText"><span class="date user-tz" title="24/Jan/06 1:31 AM"><time class="livestamp" datetime="2006-01-24T01:31-0600">24/Jan/06 1:31 AM</time></span></span>                    Well, originally, I thought that maybe something like that would work, but I don't see any way of coping with it and session without somehow having a reference to a container's session which would cause us to be back at square one. 

 Perhaps I'm missing something and you could elaborate on how you'd use it ot keep strong references away from the session yet stil have the hiearchy? 

 Thanks for giving it some thought! 

 -Mike 


             </div>
        </div>
    </div>
</div>
                             


<div id="comment-58948" class="issue-data-block activity-comment twixi-block  expanded">
    <div class="twixi-wrap verbose actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-opened"><span>Hide</span></span></a>
            <div class="action-links">
                <a href="index.htmlWAR-15?focusedCommentId=58948&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-58948" title="A permanent link to this comment." class="icon icon-perma activitymodule-link"><span>Permalink</span></a>
                                            </div>
            <div class="action-details">        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_58948_verbose" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_58948_verbose subText"><span class="date user-tz" title="17/Feb/06 3:37 PM"><time class="livestamp" datetime="2006-02-17T15:37-0600">17/Feb/06 3:37 PM</time></span></span>  </div>
        </div>
        <div class="action-body flooded"><p>Ok, here's another thought:  (Majorly pseudocode)</p>

<p>Make AppContainer, SessionContainer, and RequestContainer completely independent.</p>

<p>During Request Filter phase, create an AggregatingPicoContainer that pulls all the independent containers together and creates a pseudo hierarchy.  This pico container is destroyed at the end of the request phase.</p>

<p>public class AggregatingPicoContainer implements PicoContainer {</p>

<p>              private PicoContainer delegate;</p>

<p>             // Hierachy is such that pico<span class="error">[0]</span> == parent<br>
            // pico<span class="error">[1]</span> is child of parent, etc.<br>
             // so pico<span class="error">[0]</span> is app container, pico<span class="error">[1]</span> session container, pico<span class="error">[2]</span> request container.<br>
              public AggregatingPicoContainer(PicoContainer[] hierchy) </p>
{
                      delegate = buildPico(hierarchy);                      
               }


<p>               public PicoContainer getDelegate() </p>
{
                        return delegate;
                 }

<p>             /**</p>
<ul>
	<li>The purpose of this function is to 'clone' each container in the pseudo hierarchy and</li>
	<li>create a real hierarchy.<br>
               */<br>
            protected PicoContainer buildPico(PicoContainer[] hierarchy) 
{
                   //For Each Container In the hierarchy.
                  //Create a Mutable PicoContainer.  If i == 0, it has no parent, if i &gt; 0,  pico has parent of pico created for (i  - 1).
                 //Visit hierarchy[i], for each Component Adapter register it into created mutable Mutable PicoContainer
              //               
            }
<p>}</p></li>
</ul>



<p>The downsides to this method are:<br>
-potential performance hit.  I have no idea how much CPU/memory visiting the component adapters and registering them in the aggregating container would be.  Since this hit would be taken with each request, it could be potentially an issue, althought the biggest CPU hog, getClass() would be taken care of because each component adapter already has a reference to the component key.</p>

<p>-No container at any time other than request phase.  So if you have a thread spawned off that tries to access the container hierarchy after the request has finished, you'll have a problem.  I don't consider this a HUGE issue since:</p>

<p>(1) According to spec, you aren't supposed to spawn threads anyway.  (Although, frankly, I ignore this quite often! <img class="emoticon" src="index_files/smile.gif" alt="" height="16" align="absmiddle" border="0" width="16"> )</p>

<p>(2) If you perform proper dependency injection, the spawned component should have no need to reference pico anyway.</p>

<p>What do you think??</p>

<p>-Mike (R)</p> </div>
    </div>
    <div class="twixi-wrap concise actionContainer">
        <div class="action-head">
            <a href="#" class="twixi"><span class="icon twixi-closed"><span>Show</span></span></a>
            <div class="action-details flooded">
                        
    
    
    
                

    <a class="user-hover user-avatar" rel="rimovm" id="commentauthor_58948_concise" href="https://jira.codehaus.org/secure/ViewProfile.jspa?name=rimovm"><span class="aui-avatar aui-avatar-xsmall"><span class="aui-avatar-inner"><img src="index_files/useravatar.png"></span></span> Michael Rimov</a>
 added a comment  - <span class="commentdate_58948_concise subText"><span class="date user-tz" title="17/Feb/06 3:37 PM"><time class="livestamp" datetime="2006-02-17T15:37-0600">17/Feb/06 3:37 PM</time></span></span>                    Ok, here's another thought:  (Majorly pseudocode) 

 Make AppContainer, SessionContainer, and RequestContainer completely independent. 

 During Request Filter phase, create an AggregatingPicoContainer that pulls all the independent containers together and creates a pseudo hierarchy.  This pico container is destroyed at the end of the request phase. 

 public class AggregatingPicoContainer implements PicoContainer { 

               private PicoContainer delegate; 

              // Hierachy is such that pico [0]  == parent 
            // pico [1]  is child of parent, etc. 
             // so pico [0]  is app container, pico [1]  session container, pico [2]  request container. 
              public AggregatingPicoContainer(PicoContainer[] hierchy)  
{
                      delegate = buildPico(hierarchy);                      
               }


                public PicoContainer getDelegate()  
{
                        return delegate;
                 }

              /** 
 
	 The purpose of this function is to 'clone' each container in the pseudo hierarchy and 
	 create a real hierarchy. 
               */ 
            protected PicoContainer buildPico(PicoContainer[] hierarchy) 
{
                   //For Each Container In the hierarchy.
                  //Create a Mutable PicoContainer.  If i == 0, it has no parent, if i &gt; 0,  pico has parent of pico created for (i  - 1).
                 //Visit hierarchy[i], for each Component Adapter register it into created mutable Mutable PicoContainer
              //               
            }
 }  
 



 The downsides to this method are: 
-potential performance hit.  I have no idea how much CPU/memory visiting the component adapters and registering them in the aggregating container would be.  Since this hit would be taken with each request, it could be potentially an issue, althought the biggest CPU hog, getClass() would be taken care of because each component adapter already has a reference to the component key. 

 -No container at any time other than request phase.  So if you have a thread spawned off that tries to access the container hierarchy after the request has finished, you'll have a problem.  I don't consider this a HUGE issue since: 

 (1) According to spec, you aren't supposed to spawn threads anyway.  (Although, frankly, I ignore this quite often!   ) 

 (2) If you perform proper dependency injection, the spawned component should have no need to reference pico anyway. 

 What do you think?? 

 -Mike (R)              </div>
        </div>
    </div>
</div>
                             </div>
    </div>
</div></div></div><div id="viewissuesidebar" class="aui-item issue-side-column"><div id="peoplemodule" class="module toggle-wrap"><div id="peoplemodule_heading" class="mod-header"><ul class="ops"></ul><h2 class="toggle-title">People</h2></div><div class="mod-content"><ul class="item-details" id="peopledetails">
    <li class="people-details">
                <dl>
            <dt>Assignee:</dt>
            <dd>
                <span id="assignee-val" class="view-issue-field">

    <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="index_files/useravatar-1.png"></span></span>
    Unassigned
</span>
                            </dd>
        </dl>
                        <dl>
            <dt>Reporter:</dt>
            <dd>
                <span id="reporter-val" class="view-issue-field">

            <span class="user-hover" id="issue_summary_reporter_jamesmead" rel="jamesmead">
            <span class="aui-avatar aui-avatar-small"><span class="aui-avatar-inner"><img src="index_files/useravatar-2.png"></span></span>
            James Mead
        </span>
    </span>
            </dd>
        </dl>
                    </li>
</ul>
    <ul class="item-details">
        <li>
                            <dl>
                    <dt>Votes:</dt>
                    <dd>
                                                                            <span id="vote-data" class="aui-badge vote-state-off">0</span>
                        
                                                                                                        <span id="vote-label" title="You have to be logged in to vote for an issue.">Vote for this issue</span>
                                            </dd>
                </dl>
                                        <dl>
                    <dt>Watchers:</dt>
                    <dd>
                                                                        
                                                                            <span id="watcher-data" class="aui-badge watch-state-off">0</span>
                        
                                                                                <span id="watch-label" title="You have to be logged in to watch an issue.">Start watching this issue</span>
                                            </dd>
                </dl>
                    </li>
    </ul>
</div></div><div id="datesmodule" class="module toggle-wrap"><div id="datesmodule_heading" class="mod-header"><ul class="ops"></ul><h2 class="toggle-title">Dates</h2></div><div class="mod-content"><ul class="item-details">
    <li>
            <dl class="dates">
            <dt>Created:</dt>
            <dd class="date user-tz" title="08/Apr/05 11:02 AM">

                <span data-name="Created" id="create-date" data-fieldtype="datetime">
                                                                        <time class="livestamp" datetime="2005-04-08T11:02-0500">08/Apr/05 11:02 AM</time>                                                             </span>
            </dd>
        </dl>
            <dl class="dates">
            <dt>Updated:</dt>
            <dd class="date user-tz" title="17/Feb/06 3:37 PM">

                <span data-name="Updated" id="updated-date" data-fieldtype="datetime">
                                                                        <time class="livestamp" datetime="2006-02-17T15:37-0600">17/Feb/06 3:37 PM</time>                                                             </span>
            </dd>
        </dl>
        </li>
</ul>
</div></div></div></div>
                    </div>
                </div>
                        </div>

    <fieldset class="hidden parameters">
        <input title="autocompleteEnabled" value="true" type="hidden">
    </fieldset>
    
    </section>
    <footer id="footer" role="contentinfo">
        
        



<div class="footer-body">
    <ul>
        <li>
                        <a href="http://www.atlassian.com/software/jira">Atlassian JIRA</a>

                                                    
                        
            <span id="footer-build-information">(v6.1.6#6162-<span title="7af547ce7c84dbb7c1e345a65437ed7b85efffa2" data-commit-id="7af547ce7c84dbb7c1e345a65437ed7b85efffa2}">sha1:7af547c</span>)</span>
        </li>
        <li>
            <a id="about-link" href="https://jira.codehaus.org/secure/AboutPage.jspa">About JIRA</a>
        </li>
        <li>
                                    <a id="footer-report-problem-link" href="https://jira.codehaus.org/secure/CreateIssue%21default.jspa">Report a problem</a>
        </li>
    </ul>
            <ul>
            <li class="licensemessage">
                                    Powered by a free Atlassian <a href="http://www.atlassian.com/software/jira">JIRA</a> open source license for Codehaus. Try JIRA - <a href="http://www.atlassian.com/software/jira">bug tracking software</a> for <i>your</i> team.

                            </li>
        </ul>
    </div>

<form id="jira_request_timing_info" class="dont-default-focus">
	<fieldset class="parameters hidden">




		<input title="jira.session.expiry.in.mins" value="299" type="hidden">

	</fieldset>
</form>
<!--
	                 
	          
	               
	                 
	        CONCURRENT REQUESTS : 3



-->










<fieldset class="hidden parameters">
    <input title="loggedInUser" value="" type="hidden">
    <input title="ajaxTimeout" value="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation." type="hidden">
    <input title="JiraVersion" value="6.1.6" type="hidden">
    <input title="ajaxUnauthorised" value="You are not authorised to perform this operation.  Please log in." type="hidden">
    <input title="baseURL" value="https://jira.codehaus.org:443" type="hidden">
    <input title="ajaxCommsError" value="The JIRA server could not be contacted.  This may be a temporary glitch or the server may be down." type="hidden">
    <input title="ajaxServerError" value="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation." type="hidden">
    <input title="ajaxErrorCloseDialog" value="Close this dialog and press refresh in your browser" type="hidden">
    <input title="ajaxErrorDialogHeading" value="Communications Breakdown" type="hidden">

    <input title="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost." type="hidden">
    <input title="dirtyDialogMessage" value="You have entered new data in this dialog. If you navigate away from this dialog without first saving your data, the changes will be lost. Click cancel to return to the dialog." type="hidden">
    <input title="keyType" value="Type" type="hidden">
    <input title="keyThen" value="then" type="hidden">
    <input title="dblClickToExpand" value="Double click to expand" type="hidden">
    <input title="actions" value="Actions" type="hidden">
    <input title="removeItem" value="Remove" type="hidden">
    <input title="workflow" value="Workflow" type="hidden">
    <input title="labelNew" value="New Label" type="hidden">
    <input title="issueActionsHint" value="Begin typing for available operations or press down to see all" type="hidden">
    <input title="closelink" value="Close" type="hidden">
    <input title="dotOperations" value="Operations" type="hidden">
    <input title="dotLoading" value="Loading..." type="hidden">
    <input title="frotherSuggestions" value="Suggestions" type="hidden">
    <input title="frotherNomatches" value="No Matches" type="hidden">
    <input title="multiselectVersionsError" value="{0} is not a valid version." type="hidden">
    <input title="multiselectComponentsError" value="{0} is not a valid component." type="hidden">
    <input title="multiselectGenericError" value="The value {0} is invalid." type="hidden">
</fieldset>

    </footer>
</div>


<div id="fancybox-tmp"></div><div id="fancybox-loading"><div></div></div><div id="fancybox-overlay"></div><div id="fancybox-wrap"><div id="fancybox-outer"><div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div><div id="fancybox-content"></div><a id="fancybox-close"></a><div id="fancybox-title"></div><a href="javascript:void(0);" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a><a href="javascript:void(0);" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a></div></div><div class="navigator-sidebar collapsed ui-popout ui-popout-detached ui-popout-collapsed" id="navigator-sidebar"><a class="toggle-filter-panel" href="#" title="Dock the filters panel ([)"></a></div><div style="display: none;" class="jira-dialog box-shadow" id="edit-issue-dialog"><div class="jira-dialog-content"></div></div><div style="display: none;" class="jira-dialog box-shadow" id="create-subtask-dialog"><div class="jira-dialog-content"></div></div></body></html>